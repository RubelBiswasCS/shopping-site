{% extends 'store/base.html' %}

{% block content %}
<div class="gen-div">
    <section class="products">
        
        {% for p in products %}
        <div class="product-card">
            <figure class="card-image">
                {% load static %}
                <img src="{% static 'store/img/headphone-nbg.png' %}" alt="headphone image">
            </figure>
            <small>{{p.product_name}}</small>
            <p>{{p.unit_price}}$</p>
            <button id="add-btn" value="{{p.id}}" class="add-btn" type="submit" name="button" >Add to Cart</button>
        </div>
        {% endfor %}
        <!-- <div id="cart" style="height:100px; width:100px; background: red;">

        </div> -->
        

    </section>
    
</div>
    <script>
        
           

        //fuction for add item to the cart
        $(document).on("click","#add-btn",function(e){
            // var user_id = '{{ request.user.id }}';
            var id = $(this).val();
               e.preventDefault();
               $.ajax({
                   method:"POST",
                   url: "{% url 'add-to-cart' %}",
                   data:{
                        user_id : '{{ request.user.id }}',
                        product_id : $(this).val(),
                        csrfmiddlewaretoken: '{{ csrf_token}}',

                        
                   },
                   
                success: function(response){
                    var myObj = JSON.parse(response);
                    console.log(myObj.user_id+' '+myObj.product_id);
                    console.log('data successfully send');
                },

                error: function(){
                    console.log("something went wrong");
                },
               });

           });
        //    remove cart item

        $(document).on("click","#rm-cart-item",function(e){
            // var user_id = '{{ request.user.id }}';
            var id = $(this).val();
               e.preventDefault();
               $.ajax({
                   method:"POST",
                   url: "{% url 'remove-cart-item' %}",
                   data:{
                        user_id : '{{ request.user.id }}',
                        product_id : $(this).val(),
                        csrfmiddlewaretoken: '{{ csrf_token}}',

                        
                   },
                   
                  

                success: function(response){
                    console.log(response);
                },
                error: function(){
                    console.log("error while delete item");
                },
               });

           });
    </script>
{% endblock %}